@startuml
title Конвейер анализа сетевого трафика с использованием ML

skinparam activity {
  BackgroundColor #FFFFFF
  BorderColor #333333
}

start

:Сырой сетевой трафик\nPCAP / NetFlow / HTTP-логи;
:Загрузка и парсинг данных\n(Scapy, лоады датасетов);
:Предобработка и feature engineering\n(Pandas, очистка, кодирование категорий);

fork
  :Модель классификации\n(RandomForest / XGBoost);
  :Определение класса события\n(норма / тип атаки);
fork again
  :Модель обнаружения аномалий\n(IsolationForest и др.);
  :Выявление нетипичного поведения\n(флаг аномалии);
end fork

:Агрегация результатов\n(учёт класса, флага аномалии,\nрепутации IP);
:Формирование алертов\nи запись в БД;
:Отображение на дашборде,\nуведомление администратора;

stop
@enduml
