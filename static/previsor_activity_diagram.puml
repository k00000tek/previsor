@startuml
'https://plantuml.com/activity-diagram
title Диаграмма деятельности PreVisor

|Система|
start
:Сбор данных из сети (реальный / тестовый трафик);
:Запуск по расписанию (каждые 10 мин);
:Предобработка (очистка, нормализация, feature engineering);

:Анализ угроз (ML + эвристики);
if (Обнаружена угроза?) then (Да)
  :Генерация алерта (JSON);
  :Сохранение в БД;
  fork
    :Отправка уведомления (email/Slack);
  fork again
    :Опциональная проверка через внешние API;
  end fork
else (Нет)
  :Запись результатов в логи;
endif
:Обновление дашборда;

|Пользователь|
:Авторизация в интерфейсе;
:Просмотр графиков и алертов;
:Фильтрация и экспорт отчётов;
if (Требуется ручной анализ?) then (Да)
  :Нажимает "Запустить анализ";
  :Передача запроса Flask-приложению;
  :Flask инициирует повторный анализ;
endif
:Продолжение мониторинга;

|Внешние источники|
:Предоставление данных по IP/сигнатурам (AbuseIPDB, VirusTotal);

stop
@enduml
