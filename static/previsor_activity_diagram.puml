@startuml
title Диаграмма активности PreVisor

|Система|
start
:Мониторинг (сбор трафика);
:Коллектор формирует батчи;
:Обработчик извлекает батчи;
:Предобработка;
:Анализ угроз;
:Обогащение репутацией IP;
:Запись трафика;

if (Риск > порога?) then (Да)
  :Сформировать алерт;
  :Сохранить алерт;
  :Уведомление в Telegram;
  :Кэшировать IP репутацию;
endif
:Проверка дообучения IsolationForest;
:Обновить дашборд;

|Пользователь|
:Открыть веб‑интерфейс;
:Просмотр алертов, статистики;
:Старт/стоп мониторинга;
:Накопить baseline;
if (Разовый анализ?) then (Да)
  :Запуск разового анализа;
endif
:Обновить статусы;
:False positive → в baseline;
:Продолжить мониторинг;

|Внешние источники|
:Threat Intelligence;

stop
@enduml
