@startuml
title Диаграмма развертывания PreVisor

skinparam node {
  BackgroundColor White
  BorderColor #666
  FontColor #111
}

skinparam artifact {
  BackgroundColor #F9F9F9
  BorderColor #999
}

node "ПК пользователя\n(Windows)" as Client {
    artifact "Браузер\n(Browser)" as Browser
    artifact "Flask-приложение\n(app.py)" as FlaskApp
    artifact "Модули анализа\n(modules/*)" as AnalyzerMods
    artifact "SQLite DB\n(db/runtime/previsor.db)" as DB
}

node "Опционально" as Optional {
    artifact "Celery worker\n(celery_app.py)" as CeleryApp
    artifact "Redis broker" as Redis
}

cloud "Внешние сервисы" as Cloud {
    artifact "AbuseIPDB\nHTTP API" as TI
    artifact "Telegram Bot" as Notif
}

Browser --> FlaskApp : HTTP
FlaskApp --> AnalyzerMods : анализ/предобработка
FlaskApp --> DB : SQL
AnalyzerMods --> DB : alerts/logs
AnalyzerMods --> TI : репутация IP (опционально)
AnalyzerMods --> Notif : уведомления

CeleryApp --> Redis : broker
CeleryApp --> AnalyzerMods : плановые задачи

@enduml
